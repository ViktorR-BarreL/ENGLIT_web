<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ENGLIT - –ò–∑—É—á–µ–Ω–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ</title>
    <link rel="stylesheet" href="style.css">
    <!-- –î–æ–±–∞–≤–ª–µ–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Chart.js –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
    <div id="login-screen">
        <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ ENGLIT!</h1>
        <p>–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∏–∑—É—á–µ–Ω–∏–µ —Å–ª–æ–≤.</p>
        <button id="loginBtn">–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google</button>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Å–∫—Ä—ã—Ç –¥–æ –≤—Ö–æ–¥–∞) -->
    <div id="app-content" style="display: none;">
        <!-- –ù–û–í–´–ô –ë–õ–û–ö: –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –ø–æ –º–∞–∫–µ—Ç—É -->
        <div class="main-layout" id="mainLayout">
            <header class="app-header">
                <h1 class="app-title">ENGLIT</h1>
                <div class="user-profile-circle" id="userProfileCircle">
                    <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∞–≤–∞—Ç–∞—Ä –∏–ª–∏ –∏–∫–æ–Ω–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
                </div>
            </header>

            <div class="main-content-area">
                <div class="left-panel">
                    <div class="category-selection">
                        <input type="text" id="selectedCategoryDisplay" placeholder="–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Å–ª–æ–≤" readonly>
                        <button id="selectCategoryBtn">–≤—ã–±—Ä–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
                    </div>

                    <div class="main-buttons-grid">
                        <button class="action-button" id="learnNewWordsBtn">–ò–∑—É—á–∏—Ç—å –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞</button>
                        <button class="action-button" id="repeatWordsBtn">–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ —Å–ª–æ–≤</button>
                        <button class="action-button" id="dictionaryBtn">–°–ª–æ–≤–∞—Ä—å</button>
                        <button class="action-button" id="myWordsBtn">–°–≤–æ–∏ —Å–ª–æ–≤–∞</button>
                    </div>
                </div>

                <!-- –ë–õ–û–ö –°–¢–ê–¢–ò–°–¢–ò–ö–ò -->
                <div class="right-panel">
                    <div class="statistics-header">
                        <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                        <div class="total-learned-words">
                            <p>–í—Å–µ–≥–æ –∏–∑—É—á–µ–Ω–æ —Å–ª–æ–≤</p>
                            <span id="total-learned-count">0</span>
                        </div>
                    </div>
                    <div class="statistics-filters">
                        <button class="filter-btn active" data-period="all">–í—Å–µ</button>
                        <button class="filter-btn" data-period="3m">3 –º–µ—Å—è—Ü–∞</button>
                        <button class="filter-btn" data-period="1m">–ú–µ—Å—è—Ü</button>
                        <button class="filter-btn" data-period="1w">–ù–µ–¥–µ–ª—è</button>
                    </div>
                    <div class="statistics-chart-container">
                        <canvas id="statisticsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
        <div id="categoryModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>–í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–ª–æ–≤</h2>
                    <span class="close-button">&times;</span>
                </div>
                <div id="categoryGrid" class="category-grid">
                    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å—é–¥–∞ –∏–∑ JS -->
                </div>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–∑—É—á–µ–Ω–∏—è —Å–ª–æ–≤ -->
        <div id="learning-page" class="learning-page-container" style="display: none;">
            <div class="learning-header">
                <button id="backToMainBtn" class="back-button">&larr; –ù–∞–∑–∞–¥</button>
                <div class="progress-bar-container">
                    <div id="learningProgressBar" class="progress-bar-fill"></div>
                </div>
            </div>
            <div class="word-display-area">
                <button id="prevWordBtn" class="nav-arrow">&lt;</button>
                <div class="word-card-learning">
                    <div class="word-top-row">
                        <div id="wordDisplay" class="word-text-large"></div>
                        <!-- –ò–∫–æ–Ω–∫–∞ –¥–∏–Ω–∞–º–∏–∫–∞ –¥–ª—è TTS –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –∏–∑—É—á–µ–Ω–∏—è (–ø–æ –Ω–∞–∂–∞—Ç–∏—é) -->
                        <button id="playCurrentWordBtn" class="play-btn" title="–ü—Ä–æ—Å–ª—É—à–∞—Ç—å —Å–ª–æ–≤–æ">üîä</button>
                    </div>
                    <div id="translationDisplay" class="word-translation"></div>
                    <div id="transcriptionDisplay" class="word-transcription"></div>
                    <div id="exampleDisplay" class="word-example"></div>
                    <div class="learning-actions">
                        <button id="knowWordBtn" class="learning-action-button know-it">–ó–Ω–∞—é —Å–ª–æ–≤–æ</button>
                        <button id="learnItBtn" class="learning-action-button learn-it">–£—á–∏—Ç—å</button>
                    </div>
                </div>
                <button id="nextWordBtn" class="nav-arrow">&gt;</button>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è —Å–ª–æ–≤ (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ) -->
        <div id="repeat-page" class="repeat-page-container" style="display: none;">
            <div class="repeat-header">
                <button id="backToMainFromRepeatBtn" class="back-button">&larr; –ù–∞–∑–∞–¥</button>
                <select id="testFormatSelect" class="test-format-select">
                    <option value="view">–ü—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–≤–æ–¥–∞</option>
                    <option value="multiple-choice">–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—ã–±–æ—Ä</option>
                    <option value="text-input">–í–≤–æ–¥ –æ—Ç–≤–µ—Ç–∞</option>
                </select>
                <div class="progress-bar-container repeat-progress">
                    <div id="repeatProgressBar" class="progress-bar-fill"></div>
                </div>
            </div>

            <div class="repeat-content">
                <div class="word-card-repeat">
                    <div class="repeat-word-row">
                        <div id="repeatWordDisplay" class="repeat-word-text">–°–ª–æ–≤–æ</div>
                        <!-- –ò–∫–æ–Ω–∫–∞ –¥–∏–Ω–∞–º–∏–∫–∞ –¥–ª—è TTS –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è -->
                        <button id="playRepeatWordBtn" class="play-btn" title="–ü—Ä–æ—Å–ª—É—à–∞—Ç—å —Å–ª–æ–≤–æ">üîä</button>
                    </div>
                    <div id="testOptionsContainer" class="test-options-container">
                        <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø–æ–ª–µ –≤–≤–æ–¥–∞ -->
                        <p class="placeholder-text">–ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç", —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å.</p>
                    </div>
                    <div id="feedbackMessage" class="feedback-message"></div>
                </div>
            </div>
            <div class="repeat-actions">
                <button id="startTestBtn" class="repeat-action-button primary">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç</button>
                <button id="checkAnswerBtn" class="repeat-action-button primary" style="display: none;">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                <button id="nextQuestionBtn" class="repeat-action-button secondary" style="display: none;">–î–∞–ª–µ–µ</button>
                <button id="finishTestBtn" class="repeat-action-button primary" style="display: none;">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç</button>
            </div>
            
            <div id="testResultsContainer" class="test-results-container" style="display: none;">
                <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞:</h3>
                <p>–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: <span id="correctAnswersCount">0</span></p>
                <p>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤: <span id="incorrectAnswersCount">0</span></p>
                <button id="restartTestBtn" class="repeat-action-button primary">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–ª–æ–≤–∞—Ä—è -->
        <div id="dictionary-page" class="dictionary-page-container" style="display: none;">
            <div class="dictionary-header">
                <button id="backToMainFromDictBtn" class="back-button">&larr; –ù–∞–∑–∞–¥</button>
                <h2 class="dictionary-title">–°–ª–æ–≤–∞—Ä—å</h2>
                <input type="text" id="dictionarySearchInput" class="dictionary-search" placeholder="–ü–æ–∏—Å–∫ —Å–ª–æ–≤–∞...">
            </div>
            <div class="dictionary-columns-container">
                <div class="dict-column">
                    <h3>–ò—Å—Ö–æ–¥–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å</h3>
                    <div id="source-words-container" class="words-container dict-words-container"></div>
                </div>
                <div class="dict-column">
                    <h3>–ò–∑—É—á–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞</h3>
                    <div id="learned-words-container-dict" class="words-container dict-words-container"></div>
                </div>
                <div class="dict-column">
                    <h3>–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞</h3>
                    <div id="added-words-container-dict" class="words-container dict-words-container"></div>
                </div>
            </div>
        </div>
        
        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–°–≤–æ–∏ —Å–ª–æ–≤–∞" -->
        <div id="my-words-page" class="my-words-page-container" style="display: none;">
            <div class="my-words-header">
                <button id="backToMainFromMyWordsBtn" class="back-button">&larr; –ù–∞–∑–∞–¥</button>
                <h2 class="my-words-title">–ú–æ–∏ —Å–ª–æ–≤–∞</h2>
            </div>
            <div class="my-words-content">
                <div class="add-custom-word-panel">
                    <h3>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —Å–ª–æ–≤–æ</h3>
                    <form id="add-custom-word-form" class="custom-word-form">
                        <input type="text" id="word-en-custom" placeholder="–°–ª–æ–≤–æ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º" required>
                        <input type="text" id="word-ru-custom" placeholder="–ü–µ—Ä–µ–≤–æ–¥ –Ω–∞ —Ä—É—Å—Å–∫–∏–π" required>
                        <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </form>
                </div>
                <div class="custom-words-list-panel">
                    <h3>–°–ø–∏—Å–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤</h3>
                    <div id="custom-words-list" class="words-container custom-words-container">
                        <!-- –°—é–¥–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∫–∞—Ä—Ç–æ—á–∫–∏ —Å–ª–æ–≤ -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –õ–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ -->
        <div id="profile-page" class="profile-page-container" style="display: none;">
            <div class="profile-header">
                <button id="backToMainFromProfileBtn" class="back-button">&larr; –ù–∞–∑–∞–¥</button>
                <h2 class="profile-title">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>
            </div>
            <div class="profile-content">
                <div class="profile-avatar-section">
                    <div id="profile-avatar-display" class="profile-avatar-display"></div>
                </div>
                <div class="profile-details-section">
                    <p id="profile-displayName" class="profile-name-display"></p>
                    <p id="profile-email" class="profile-email-display"></p>
                    <div class="profile-actions">
                        <button id="logoutBtn" class="profile-action-button logout">–í—ã–π—Ç–∏</button>
                        <button id="theme-toggle-btn" class="profile-action-button theme-toggle">–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Å–∫—Ä—ã—Ç–∞) -->
        <div id="admin-panel" style="display: none;">
            <h2>–ü–∞–Ω–µ–ª—å –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
            <div class="admin-forms">
                <form id="add-category-form">
                    <h3>–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h3>
                    <input type="text" id="category-id" placeholder="ID (–Ω–∞–ø—Ä–∏–º–µ—Ä, networking)" required>
                    <input type="text" id="category-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –°–µ—Ç–∏)" required>
                    <textarea id="category-desc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"></textarea>
                    <button type="submit">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
                </form>
                <form id="add-word-form">
                    <h3>–î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ</h3>
                    <input type="text" id="word-en" placeholder="–°–ª–æ–≤–æ (–∞–Ω–≥.)" required>
                    <input type="text" id="word-ru" placeholder="–ü–µ—Ä–µ–≤–æ–¥" required>
                    <input type="text" id="word-transcription" placeholder="–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è">
                    <textarea id="word-example" placeholder="–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"></textarea>
                    <input type="text" id="word-audio" placeholder="URL –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞">
                    <select id="word-category-select" required>
                        <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é...</option>
                    </select>
                    <button type="submit">–î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ</button>
                </form>
            </div>
            <hr>
        </div>

        <!-- –°—Ç–∞—Ä—ã–π —Å–ª–æ–≤–∞—Ä—å (—Å–∫—Ä—ã—Ç) -->
        <div class="dictionary-columns" style="display: none;">
            <h2>–°–ª–æ–≤–∞—Ä—å</h2>
            <div class="word-column">
                <h3>–ù–æ–≤—ã–µ</h3>
                <div id="new-words-container" class="words-container"></div>
            </div>
            <div class="word-column">
                <h3>–ò–∑—É—á–∞—é</h3>
                <div id="learning-words-container" class="words-container"></div>
            </div>
            <div class="word-column">
                <h3>–ò–∑—É—á–µ–Ω–æ</h3>
                <div id="learned-words-container" class="words-container"></div>
            </div>
        </div>
    </div>

    <!-- –°–∫—Ä–∏–ø—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Firebase (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, doc, addDoc, setDoc, getDoc, updateDoc, increment, getDocs, serverTimestamp, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAmB_8mAwRyMyPuS37hM3jZxM3zwXYThgY",
            authDomain: "englit-999d9.firebaseapp.com",
            projectId: "englit-999d9",
            storageBucket: "englit-999d9.appspot.com",
            messagingSenderId: "360161037435",
            appId: "1:360161037435:web:fb4d86261183b7fe0aa6de",
            measurementId: "G-RSJPH1B9QY"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        window.db = db;
        window.collection = collection;
        window.doc = doc;
        window.addDoc = addDoc;
        window.setDoc = setDoc;
        window.getDoc = getDoc;
        window.updateDoc = updateDoc;
        window.increment = increment;
        window.getDocs = getDocs; 
        window.serverTimestamp = serverTimestamp; 
        window.query = query; 
        window.orderBy = orderBy; 
        window.auth = auth;
        window.GoogleAuthProvider = GoogleAuthProvider;
        window.signInWithPopup = signInWithPopup;
        window.signOut = signOut;
        window.onAuthStateChanged = onAuthStateChanged;
    </script>
    
    <script src="script.js" defer></script>
</body>
</html>